@page "/video-upscale/{VideoId:guid}"
@rendermode InteractiveServer
@attribute [Authorize]
<PageTitle>Upscale Video - EzioHost</PageTitle>
<HeadContent>
    <link rel="stylesheet" href="https://unpkg.com/slick-image-compare/dist/slick-image-compare.css">
</HeadContent>

<div class="upscale-page-container">
    <div class="upscale-header">
        <h1 class="upscale-title">
            <i class="bi bi-stars"></i>
            Video Upscaling
        </h1>
        <p class="upscale-subtitle">Nâng cấp chất lượng video với AI</p>
    </div>

    <div class="upscale-content">
        @if (RendererInfo.IsInteractive)
        {
            <div class="upscale-card">
                <div class="model-selector-section">
                    <label class="model-selector-label">
                        <i class="bi bi-cpu"></i>
                        Chọn mô hình AI
                    </label>
                    <select @onchange="OnOnnxModelChange" class="model-select">
                        @foreach (var model in OnnxModels)
                        {
                            <option value="@model.Id">@model.Name</option>
                        }
                    </select>
                    <p class="model-selector-hint">Chọn mô hình AI để nâng cấp video</p>
                </div>

                @if (_selectedModel != null)
                {
                    <div class="model-details-card">
                        <h3 class="model-details-title">
                            <i class="bi bi-info-circle"></i>
                            Chi tiết mô hình
                        </h3>

                        <div class="model-details-grid">
                            <div class="model-detail-item">
                                <label class="model-detail-label">Tên mô hình</label>
                                <div class="model-detail-value">@_selectedModel.Name</div>
                            </div>
                            <div class="model-detail-item">
                                <label class="model-detail-label">Hệ số upscale</label>
                                <div class="model-detail-value">@_selectedModel.Scale x</div>
                            </div>
                        </div>

                        <div class="comparison-section">
                            <label class="comparison-label">
                                <i class="bi bi-images"></i>
                                So sánh mẫu
                            </label>
                            <div class="comparison-container">
                                <ImageCompare @ref="ImageCompareComponent"
                                              BeforeImage="@_selectedModel.DemoInput"
                                              AfterImage="@_selectedModel.DemoOutput"/>
                            </div>
                        </div>

                        <button class="upscale-button"
                                @onclick="RequestUpscaleVideo">
                            <i class="bi bi-stars"></i>
                            Xử lý Upscale
                        </button>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="loading-container">
                <div class="loading-spinner"></div>
                <p>Đang khởi tạo thành phần upscaler...</p>
            </div>
        }
    </div>
</div>